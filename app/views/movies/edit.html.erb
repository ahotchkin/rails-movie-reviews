<h1>Edit <%= @movie.title %></h1>

<% if @movie.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@movie.errors.count, "error") %> prohibited this movie from being saved:</h2>

    <ul>
    <% @movie.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>

<%= form_for @movie do |f| %>
  <%= f.label "Title:" %>
  <%= f.text_field :title %>
  <br><br>
  <%= f.label "Synopsis:" %>
  <%= f.text_area :synopsis %>
  <br><br>
  <%= f.label "Year:" %>
  <%= f.select :year, (Date.today.year-100)..(Date.today.year), :selected => @movie.year %>
  <br><br>

  <%# this code doesn't work in the controller %>
  <% genre_number = 3 - @movie.genres.size %>
  <% genre_number.times { @movie.genres.build } %>

  <%= f.label "Genre(s):" %>
  <br>
  <%= f.fields_for :genres do |genre| %>
    <%= genre.text_field :name %>
    <br>
  <% end %>
  <br><br>

  <%# this code doesn't work in the controller %>
  <%# actor is showing as invalid even when first name is filled in %>
  <% actor_number = 8 - @movie.actors.size %>
  <% actor_number.times { @movie.actors.build } %>

  <%= f.label "Starring:" %>
  <br>
  <%= f.fields_for :actors do |actor| %>
      <%= actor.label "First Name:" %>
      <%= actor.text_field :first_name %>

      <%= actor.label "Last Name:" %>
      <%= actor.text_field :last_name %>
      <br>
    <% end %>
  <br><br>

  <%= f.submit "Update Movie" %>
<% end %>
